## Программирование системного таймера
Существует два устройства работы со временем.
1. Системный таймер
2. Часы реального времени (RTC)

RTC - питается от аккумулятора, установки будильника и вызова прерываний (ARQ4) происходит каждую миллисекунду.

Используется для прерывания ARQ0 с частотой 18.2 Гц

### Определение даты
```
mov ah, 2Ah
int 21h
```
- cx - год [1980-2099]
- dh - месяц
- dl - день
- al - день недели

### Определение времени
```
mov ah, 2Ch
int 21h
```
- ch - час
- cl - минуты
- dh - секунды
- 

### Задание даты
```
mov ah, 2Bh
int 21h
```
Параметры как и в определении даты

- ah == 00h - ошибок нет
- ah == FFh - такой даты не существует


### Задание времени
```
mov ah, 2Dh
int 21h
```


## Программирование часов реального времени
### Определение даты
Пользуемся не командой ОС, а BIOS.
```
mov ah, 04h
int 1Ah
```

- cf == 0 - дата успешно прочитана
- cf == 1 - часы либо не работают, либо чтение попало в момент обновления
- cx - год в формате BCD
- dh - месяц в формате BCD
- dl - день в формате BCD

### Определение времени
```
mov ah, 02h
int 1Ah
```

- cf == 0 - успешно прочитана
- ch - час
- cl - минуты
- dh - секунды
- dl - летнее или зимнее время

### Установка будильника
```
mov ah, 06h
int 1Ah
mov ch, час
mov cl, минуты
mov dh, секунды
```
В момент совпадения времени с заданным временем будильника произойдет прерывание `ARQ8`, или `int 4Ah`

## Программирование на уровне портов ввода-ввывода
Каждой устройству соответсвует порт с определенным номером. Программно мы можем считать из порта число в регистр, а так же послать содержимого регистра в порт.

Записывает из порта в регистр
```
in регистр, номер порта
```

Пишет в порт из регистра
```
out номер порта, регистр
```

### Клавиатура
Контроллеру клавиатуры соответствуют порты в диапазоне [60h - 6Fh]

- 64h - регистр состояния клавиатуры
- 61h - регистр управления клавиатурой

### Звуковая карта
Порты 210h, 220h, 230h, ... 280h

### Часы реального времени
Порты 70h и 71h

## Примеры программирования портов ввода-вывода
1. COM средствами ОС
ОС связывает с COM1 устройство `STDAUX`, куда можно записывать или считывать информацию по 1 байту 2400 бод.

Считывание
```
mov ah, 03h
int 21h
```
Результат будет лежать в al

Отправка
```
mov ah, 04h
mov dl, байт

2. Средства BIOS
Инициализация
```
mov ah, 0
mov al, 11100011b
mov dx, номер порта
int 14h
```

Запись
```
mov ah, 01h
mov al, байт
mov dx, номер порта
int 14h
```

Чтение
```
mov ah, 02h
mov dx, номер порта
int 14h
```

3. LPT
- ah - состояние порта
- al - информация